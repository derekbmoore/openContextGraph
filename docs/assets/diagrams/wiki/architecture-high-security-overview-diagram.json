{
  "title": "High-Security Architecture â€” Defense-in-Depth (FedRAMP High / IL5)",
  "type": "architecture",
  "nodes": [
    { "id": "root", "label": "High-Security Architecture (Zero Trust Data Isolation)", "type": "rect", "color": "#f472b6" },
    { "id": "layer1", "label": "Layer 1: Zero Trust Identity (ABAC + RBAC)", "type": "rect", "color": "#f472b6" },
    { "id": "rbac", "label": "RBAC: Roles (Admin, Analyst, User)", "type": "rect", "color": "#60a5fa" },
    { "id": "abac", "label": "ABAC: Claims/Groups (Dept:Finance, Proj:Manhattan)", "type": "rect", "color": "#a78bfa" },
    { "id": "agent_identity", "label": "Agent Identity: Service Principals (same restrictions as users)", "type": "note", "color": "#94a3b8" },
    { "id": "layer2", "label": "Layer 2: Ingestion Provenance (Antigravity)", "type": "rect", "color": "#22c55e" },
    { "id": "classification", "label": "Classification: Class A (Truth) / Class C (Ops) + ACL injection", "type": "rect", "color": "#22c55e" },
    { "id": "acl", "label": "ACL: Every chunk carries immutable acl_groups metadata", "type": "note", "color": "#94a3b8" },
    { "id": "layer3", "label": "Layer 3: Memory Isolation (Zep/Tri-Search)", "type": "rect", "color": "#f59e0b" },
    { "id": "filter", "label": "Mandatory Filter: tenant_id + (user_id OR acl_groups intersection)", "type": "rect", "color": "#f59e0b" },
    { "id": "layer4", "label": "Layer 4: Database Hardening (PostgreSQL RLS)", "type": "rect", "color": "#a78bfa" },
    { "id": "rls", "label": "Row-Level Security: Policies enforce tenant + group boundaries", "type": "rect", "color": "#a78bfa" },
    { "id": "compliance", "label": "Compliance: NIST AI RMF (MANAGE 1.3, 2.3, MEASURE 2.1, GOVERN 1.2)", "type": "note", "color": "#94a3b8" }
  ],
  "edges": [
    { "source": "root", "target": "layer1", "label": "defense layer" },
    { "source": "layer1", "target": "rbac", "label": "functional" },
    { "source": "layer1", "target": "abac", "label": "data access" },
    { "source": "layer1", "target": "agent_identity", "label": "applies to" },
    { "source": "root", "target": "layer2", "label": "defense layer" },
    { "source": "layer2", "target": "classification", "label": "tags data" },
    { "source": "classification", "target": "acl", "label": "includes" },
    { "source": "root", "target": "layer3", "label": "defense layer" },
    { "source": "layer3", "target": "filter", "label": "enforces" },
    { "source": "root", "target": "layer4", "label": "defense layer" },
    { "source": "layer4", "target": "rls", "label": "enforces" },
    { "source": "root", "target": "compliance", "label": "meets" }
  ]
}
