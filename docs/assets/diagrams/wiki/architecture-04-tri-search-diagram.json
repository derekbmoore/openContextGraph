{
  "title": "Tri-Search™ — Keyword + Vector + Graph Fusion (RRF)",
  "type": "architecture",
  "nodes": [
    { "id": "query", "label": "User Query", "type": "rect", "color": "#94a3b8" },

    { "id": "keyword", "label": "Keyword Search (BM25 / inverted index)", "type": "rect", "color": "#60a5fa" },
    { "id": "vector", "label": "Vector Search (pgvector cosine similarity)", "type": "rect", "color": "#a78bfa" },
    { "id": "graph", "label": "Graph Search (Graphiti traversal)", "type": "rect", "color": "#22c55e" },

    { "id": "rrf", "label": "Fusion: Reciprocal Rank Fusion (RRF)", "type": "rect", "color": "#ef4444" },
    { "id": "rrf_eq", "label": "Score = 1 / (k + rank)", "type": "note", "color": "#94a3b8" },

    { "id": "results", "label": "Ranked Results (with provenance)", "type": "rect", "color": "#f59e0b" },
    { "id": "api", "label": "API: POST /api/v1/memory/search", "type": "note", "color": "#94a3b8" },
    { "id": "impl", "label": "Implementation: backend/memory/client.py", "type": "note", "color": "#94a3b8" },
    { "id": "deep_dive", "label": "Deep dive: Graph Knowledge (Gk) + Tri-Search™", "type": "link", "color": "#94a3b8" }
  ],
  "edges": [
    { "source": "query", "target": "keyword", "label": "retrieve candidates" },
    { "source": "query", "target": "vector", "label": "retrieve candidates" },
    { "source": "query", "target": "graph", "label": "retrieve candidates" },

    { "source": "keyword", "target": "rrf", "label": "ranked list" },
    { "source": "vector", "target": "rrf", "label": "ranked list" },
    { "source": "graph", "target": "rrf", "label": "ranked list" },

    { "source": "rrf", "target": "rrf_eq", "label": "scoring" },
    { "source": "rrf", "target": "results", "label": "fused ranking" },

    { "source": "results", "target": "api", "label": "served via" },
    { "source": "results", "target": "impl", "label": "implemented in" },
    { "source": "results", "target": "deep_dive", "label": "learn more" }
  ]
}

