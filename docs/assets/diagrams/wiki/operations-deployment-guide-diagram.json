{
  "title": "Deployment Guide — Azure Infrastructure Provisioning Flow",
  "type": "flowchart",
  "nodes": [
    { "id": "start", "label": "Deploy ctxEco to Customer Tenant", "type": "rect", "color": "#94a3b8" },
    { "id": "prereq", "label": "Prerequisites: Azure Subscription, CLI, Domain, CIAM Tenant", "type": "rect", "color": "#60a5fa" },
    { "id": "rg", "label": "Step 1: Create Resource Group + Managed Identities", "type": "rect", "color": "#34d399" },
    { "id": "bicep", "label": "Step 2: Provision Infrastructure (Bicep: ACA, PostgreSQL, KV, Storage, Speech)", "type": "rect", "color": "#34d399" },
    { "id": "secrets", "label": "Step 3: Seed Key Vault Secrets (postgres, zep, ai-key, voicelive, speech, etc.)", "type": "rect", "color": "#f472b6" },
    { "id": "deploy", "label": "Step 4: Deploy Backend + Frontend (CI/CD or manual)", "type": "rect", "color": "#22c55e" },
    { "id": "dns", "label": "Step 5: Configure DNS (custom domains → SWA + ACA)", "type": "rect", "color": "#94a3b8" },
    { "id": "verify", "label": "Step 6: Verify (readiness checklist)", "type": "rect", "color": "#f59e0b" },
    { "id": "resources", "label": "Resources: Container Apps Env, PostgreSQL, Key Vault, Storage, Log Analytics, Speech", "type": "note", "color": "#94a3b8" },
    { "id": "region", "label": "Region: westus2/eastus2 (Avatar requires westus2/northeurope/southeastasia)", "type": "note", "color": "#94a3b8" }
  ],
  "edges": [
    { "source": "start", "target": "prereq", "label": "verify" },
    { "source": "prereq", "target": "rg", "label": "step 1" },
    { "source": "rg", "target": "bicep", "label": "step 2" },
    { "source": "bicep", "target": "secrets", "label": "step 3" },
    { "source": "secrets", "target": "deploy", "label": "step 4" },
    { "source": "deploy", "target": "dns", "label": "step 5" },
    { "source": "dns", "target": "verify", "label": "step 6" },
    { "source": "bicep", "target": "resources", "label": "creates" },
    { "source": "prereq", "target": "region", "label": "consider" }
  ]
}
